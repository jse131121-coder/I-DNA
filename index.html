<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AOUSE</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  background:#ffdbe7;
  font-family:-apple-system,BlinkMacSystemFont,"Apple SD Gothic Neo",sans-serif;
  display:flex;justify-content:center;
}
#app{
  width:390px;min-height:100vh;
  background:#ffeef4;padding-bottom:70px;
}

/* NAV */
nav{
  position:fixed;bottom:0;width:390px;height:60px;
  background:#fff;display:flex;border-top:1px solid #ddd;
}
nav button{flex:1;border:none;background:none;font-size:11px}

/* PAGE */
.page{display:none;padding:15px}
.page.active{display:block}

/* LOGIN */
#loginModal{
  position:fixed;inset:0;background:rgba(0,0,0,.45);
  display:flex;align-items:center;justify-content:center;z-index:99
}
#loginBox{
  width:280px;background:#fff;border-radius:14px;padding:20px
}
#loginBox input{width:100%;padding:8px;margin-bottom:10px}

/* BUTTON */
button{
  background:#ffb3c7;border:none;padding:6px 10px;
  border-radius:10px;font-size:12px
}

/* CHAT */
.chat{display:flex;margin-bottom:6px}
.chat.artist{justify-content:flex-start}
.chat.fan{justify-content:flex-end}
.bubble{
  max-width:70%;padding:8px;font-size:12px;
  border-radius:14px;box-shadow:0 2px 6px rgba(0,0,0,.15)
}
.artist .bubble{background:#ffc0cb}
.fan .bubble{background:#fff}
.date{font-size:10px;color:#777;margin-top:2px}

/* POST */
.post{
  background:#fff;border-radius:14px;padding:10px;margin-bottom:12px
}
.post img{width:100%;border-radius:10px;margin-top:6px}
.comment{font-size:12px;margin-top:6px}

/* PROFILE */
.profile{text-align:center}
.profile img{
  width:80px;height:80px;border-radius:50%;
  background:#ccc;margin-bottom:10px
}
</style>
</head>

<body>
<div id="app">

<!-- LOGIN -->
<div id="loginModal">
  <div id="loginBox">
    <h3>AOUSE</h3>
    <input id="email" placeholder="email">
    <input id="pw" type="password" placeholder="password">
    <button onclick="login()">Login</button>
  </div>
</div>

<div id="home" class="page active"><h3>Home</h3></div>

<div id="community" class="page">
  <button onclick="openPost()">글쓰기</button>
  <div id="postList"></div>
</div>

<div id="chat" class="page">
  <div id="chatBox"></div>
  <input id="chatInput">
  <button onclick="sendChat()">보내기</button>
</div>

<div id="letter" class="page">
  <textarea id="letterText"></textarea>
  <button onclick="sendLetter()">보내기</button>
  <div id="letterList"></div>
</div>

<div id="setting" class="page">
  <div class="profile">
    <img id="profileImg">
    <input type="file" onchange="uploadProfile(event)">
    <input id="nameInput">
    <button onclick="saveProfile()">저장</button>
  </div>
</div>

<nav>
  <button onclick="show('home')">홈</button>
  <button onclick="show('community')">커뮤니티</button>
  <button onclick="show('chat')">채팅</button>
  <button onclick="show('letter')">편지</button>
  <button onclick="show('setting')">설정</button>
</nav>

</div>

<script>
const store=localStorage;
let state=JSON.parse(store.aouse||"{}");

/* INIT */
if(state.user){
  loginModal.style.display="none";
}else{
  state={posts:[],chats:[],letters:[],user:null}
}

/* LOGIN */
function login(){
  if(email.value==="aini@house.com"&&pw.value==="1234"){
    state.user={role:"fan",name:"FAN"};
  }else if(email.value==="ahjin@house.com"&&pw.value==="01024773752"){
    state.user={role:"artist",name:"AHJIN",img:""};
  }else return alert("실패");
  save();loginModal.style.display="none";renderAll();
}

/* SAVE */
function save(){store.aouse=JSON.stringify(state)}

/* NAV */
function show(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* CHAT */
function sendChat(){
  state.chats.push({
    role:state.user.role,
    text:chatInput.value,
    date:new Date().toLocaleString()
  });
  chatInput.value="";save();renderChat();
}
function renderChat(){
  chatBox.innerHTML="";
  state.chats.forEach(c=>{
    const d=document.createElement('div');
    d.className="chat "+c.role;
    d.innerHTML=`<div class="bubble">${c.text}<div class="date">${c.date}</div></div>`;
    chatBox.appendChild(d);
  });
}

/* COMMUNITY */
function openPost(){
  const t=prompt("내용");
  if(!t)return;
  state.posts.unshift({
    text:t,
    img:null,
    author:state.user.name,
    date:new Date().toLocaleString(),
    comments:[]
  });
  save();renderPosts();
}
function renderPosts(){
  postList.innerHTML="";
  state.posts.forEach((p,i)=>{
    const d=document.createElement('div');
    d.className="post";
    d.innerHTML=`<b>${p.author}</b><div class="date">${p.date}</div><p>${p.text}</p>`;
    postList.appendChild(d);
  });
}

/* LETTER */
function sendLetter(){
  state.letters.push({text:letterText.value,date:new Date().toLocaleString()});
  letterText.value="";save();renderLetters();
}
function renderLetters(){
  letterList.innerHTML="";
  state.letters.forEach(l=>{
    const d=document.createElement('div');
    d.innerHTML=`${l.text}<div class="date">${l.date}</div>`;
    letterList.appendChild(d);
  });
}

/* PROFILE */
function uploadProfile(e){
  const r=new FileReader();
  r.onload=()=>{state.user.img=r.result;profileImg.src=r.result;save()}
  r.readAsDataURL(e.target.files[0]);
}
function saveProfile(){
  state.user.name=nameInput.value;save();alert("저장됨");
}

/* RENDER ALL */
function renderAll(){
  renderChat();renderPosts();renderLetters();
  if(state.user?.img)profileImg.src=state.user.img;
  nameInput.value=state.user?.name||"";
}
renderAll();
</script>
</body>
</html>

