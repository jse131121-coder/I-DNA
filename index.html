<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>MVP Community</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{
      --yellow:#FFE066;
      --yellow-soft:#FFF4B8;
      --gray:#444;
    }
    *{box-sizing:border-box;font-family:system-ui, -apple-system, BlinkMacSystemFont, sans-serif}
    body{margin:0;background:#fafafa;color:#111}

    /* layout */
    header{background:var(--yellow);padding:12px;font-weight:700;text-align:center}
    nav{display:flex;border-bottom:1px solid #ddd}
    nav button{flex:1;padding:12px;border:0;background:#fff;font-weight:600}
    nav button.active{background:var(--yellow-soft)}
    section{display:none;padding:14px}
    section.active{display:block}

    /* common */
    .card{background:#fff;border-radius:12px;padding:12px;margin-bottom:12px;box-shadow:0 1px 4px rgba(0,0,0,.06)}
    .row{display:flex;gap:8px;align-items:center}
    .avatar{width:36px;height:36px;border-radius:50%;background:#ccc;flex-shrink:0}
    .badge{font-size:11px;padding:2px 6px;border-radius:8px;background:#000;color:#fff;margin-left:6px}
    textarea,input{width:100%;padding:8px;border-radius:8px;border:1px solid #ccc}
    textarea{resize:vertical}
    button.primary{background:var(--yellow);border:0;padding:8px 12px;border-radius:8px;font-weight:600}

    /* feed / notice */
    .post-img{width:100%;border-radius:8px;margin-top:8px}
    .comment{margin-top:8px;padding-left:44px}
    .reply{margin-top:6px;padding-left:72px;font-size:14px}

    /* chat */
    .chat-wrap{display:flex;flex-direction:column;gap:10px}
    .bubble{max-width:70%;padding:10px;border-radius:14px;white-space:pre-wrap}
    .left{align-self:flex-start;background:#fff;border:1px solid #ddd}
    .right{align-self:flex-end;background:var(--yellow)}
    .chat-meta{display:flex;align-items:center;gap:6px;margin-bottom:2px}
    .chat-img{max-width:200px;border-radius:10px;margin-top:6px}
    .chat-input{display:flex;gap:6px;margin-top:10px}

    /* login */
    #login{padding:20px}
    #login.hidden{display:none}
  </style>
</head>
<body>

<header>COMMUNITY MVP</header>

<div id="login">
  <div class="card">
    <input id="loginId" placeholder="ÏïÑÏù¥Îîî" />
    <input id="loginPw" type="password" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏" />
    <button class="primary" onclick="login()">Î°úÍ∑∏Ïù∏</button>
    <button onclick="guest()">Î°úÍ∑∏Ïù∏ Í±¥ÎÑàÎõ∞Í∏∞ (ÏùΩÍ∏∞ Ï†ÑÏö©)</button>
  </div>
</div>

<div id="app" style="display:none">
  <nav>
    <button onclick="tab('feed')" class="active">FEED</button>
    <button onclick="tab('chat')">CHAT</button>
    <button onclick="tab('notice')">NOTICE</button>
  </nav>

  <!-- FEED -->
  <section id="feed" class="active">
    <div id="feedWrite"></div>
    <div id="feedList"></div>
  </section>

  <!-- CHAT -->
  <section id="chat">
    <div class="chat-wrap" id="chatList"></div>
    <div class="chat-input" id="chatInput"></div>
  </section>

  <!-- NOTICE -->
  <section id="notice">
    <div id="noticeWrite"></div>
    <div id="noticeList"></div>
  </section>
</div>

<script>
/* ---- state ---- */
const users={ yerin:{pw:'1234',role:'admin',name:'Yerin',badge:'ADMIN'} };
let currentUser=null;
let readonly=false;
const feed=JSON.parse(localStorage.getItem('feed')||'[]');
const notice=JSON.parse(localStorage.getItem('notice')||'[]');
const chat=JSON.parse(localStorage.getItem('chat')||'[]');

/* ---- login ---- */
function login(){
  const id=loginId.value;const pw=loginPw.value;
  if(users[id]&&users[id].pw===pw){currentUser={id,...users[id]};start();}
  else alert('Î°úÍ∑∏Ïù∏ Ïã§Ìå®');
}
function guest(){readonly=true;start();}
function start(){login.classList.add('hidden');app.style.display='block';renderAll();}

/* ---- tab ---- */
function tab(t){
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  event.target.classList.add('active');
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(t).classList.add('active');
}

/* ---- FEED ---- */
function renderFeed(){
  feedWrite.innerHTML='';
  if(currentUser&&!readonly&&currentUser.role==='artist'){
    feedWrite.innerHTML=`<div class="card">
      <input id="ftitle" placeholder="Ï†úÎ™©" />
      <textarea id="fbody" placeholder="ÎÇ¥Ïö©"></textarea>
      <input type="file" id="fimg" />
      <button class="primary" onclick="addFeed()">Îì±Î°ù</button>
    </div>`;
  }
  feedList.innerHTML=feed.map(p=>`
    <div class="card">
      <div class="row"><div class="avatar"></div><b>${p.author}</b></div>
      <h4>${p.title}</h4>
      <div style="white-space:pre-wrap">${p.body}</div>
      ${p.img?`<img class="post-img" src="${p.img}"/>`:''}
      <div>${p.comments.map(c=>`<div class="comment">üí¨ ${c.text}${c.replies.map(r=>`<div class="reply">‚Ü≥ ${r}</div>`).join('')}</div>`).join('')}</div>
    </div>`).join('');
}
function addFeed(){
  const r=new FileReader();
  r.onload=()=>{feed.unshift({author:currentUser.name,title:ftitle.value,body:fbody.value,img:r.result,comments:[]});save();}
  if(fimg.files[0])r.readAsDataURL(fimg.files[0]);else{feed.unshift({author:currentUser.name,title:ftitle.value,body:fbody.value,img:null,comments:[]});save();}
}

/* ---- CHAT ---- */
function renderChat(){
  chatList.innerHTML=chat.map(m=>`
    <div class="bubble ${m.side}">
      ${m.showMeta?`<div class="chat-meta"><div class="avatar"></div><b>${m.name}</b><span class="badge">${m.badge}</span></div>`:''}
      ${m.text}${m.img?`<img class="chat-img" src="${m.img}"/>`:''}
    </div>`).join('');
  chatInput.innerHTML= readonly?'':`
    <textarea id="ctext"></textarea>
    <input type="file" id="cimg" />
    <button class="primary" onclick="sendChat()">Ï†ÑÏÜ°</button>`;
}
function sendChat(){
  const r=new FileReader();
  r.onload=()=>{chat.push(makeMsg(r.result));save();}
  if(cimg.files[0])r.readAsDataURL(cimg.files[0]);else{chat.push(makeMsg(null));save();}
}
function makeMsg(img){
  const isArtist=currentUser&&currentUser.role!=='fan';
  return{ text:ctext.value, img, side:isArtist?'left':'right', name:currentUser.name, badge:currentUser.badge||'', showMeta:isArtist };
}

/* ---- NOTICE ---- */
function renderNotice(){
  noticeWrite.innerHTML='';
  if(currentUser&&currentUser.id==='yerin'){
    noticeWrite.innerHTML=`<div class="card">
      <input id="ntitle" placeholder="Í≥µÏßÄ Ï†úÎ™©" />
      <textarea id="nbody"></textarea>
      <input type="file" id="nimg" />
      <button class="primary" onclick="addNotice()">Í≥µÏßÄ Îì±Î°ù</button>
    </div>`;
  }
  noticeList.innerHTML=notice.map(p=>`
    <div class="card">
      <h4>${p.title}</h4>
      <div style="white-space:pre-wrap">${p.body}</div>
      ${p.img?`<img class="post-img" src="${p.img}"/>`:''}
    </div>`).join('');
}
function addNotice(){
  const r=new FileReader();
  r.onload=()=>{notice.unshift({title:ntitle.value,body:nbody.value,img:r.result});save();}
  if(nimg.files[0])r.readAsDataURL(nimg.files[0]);else{notice.unshift({title:ntitle.value,body:nbody.value,img:null});save();}
}

function save(){localStorage.setItem('feed',JSON.stringify(feed));localStorage.setItem('notice',JSON.stringify(notice));localStorage.setItem('chat',JSON.stringify(chat));renderAll();}
function renderAll(){renderFeed();renderChat();renderNotice();}
</script>
</body>
</html>



