<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AND,JIN</title>

<style>
:root{
  --pink:#ffd6e0;
  --deep:#ff8fa3;
  --white:#fff;
  --shadow:0 6px 16px rgba(0,0,0,.15);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--pink);
}
.hidden{display:none}
.small{font-size:12px}
.card{
  background:var(--white);
  border-radius:16px;
  padding:14px;
  box-shadow:var(--shadow);
  margin-bottom:12px;
}
button{
  background:var(--deep);
  border:none;
  color:#fff;
  border-radius:12px;
  padding:10px;
  font-size:12px;
}
input,textarea{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ddd;
  font-size:12px;
}
header{
  padding:12px;
  text-align:center;
  font-weight:700;
}
section{
  padding:14px;
  padding-bottom:90px;
}
nav{
  position:fixed;
  bottom:0;left:0;right:0;
  background:#fff;
  display:flex;
  border-top:1px solid #eee;
}
nav button{
  flex:1;
  background:none;
  color:#555;
}
.avatar{
  width:34px;height:34px;
  border-radius:50%;
  background:#ccc;
  object-fit:cover;
}
.row{display:flex;align-items:center;gap:8px}

/* 채팅 */
.chat{display:flex;flex-direction:column;gap:8px}
.bubble{
  max-width:75%;
  padding:10px;
  border-radius:14px;
  box-shadow:var(--shadow);
  font-size:12px;
}
.left{align-self:flex-start;background:#ffc1c1}
.right{align-self:flex-end;background:#fff}

/* 로그인 */
#login{
  position:fixed;inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
}
</style>
</head>

<body>

<!-- 로그인 -->
<div id="login">
  <div class="card" style="width:85%">
    <h3>LOGIN</h3>
    <input id="loginEmail" placeholder="email">
    <input id="loginPw" type="password" placeholder="password">
    <button onclick="login()">로그인</button>
  </div>
</div>

<header>AND,JIN</header>

<section id="home" class="hidden">
  <div class="card">HOME</div>
</section>

<section id="community" class="hidden">
  <button onclick="newPost()">글쓰기</button>
  <div id="posts"></div>
</section>

<section id="chat" class="hidden">
  <div id="chatBox" class="chat"></div>
  <div class="row">
    <input id="chatInput">
    <button onclick="sendChat()">전송</button>
  </div>
</section>

<section id="settings" class="hidden">
  <div class="card">
    <h4>설정</h4>

    <div id="artistSetting" class="hidden">
      <label class="small">아티스트 이름</label>
      <input id="artistName">
      <label class="small">프로필 이미지 업로드</label>
      <input type="file" accept="image/*" onchange="uploadAvatar(this)">
      <button onclick="saveArtist()">저장</button>
    </div>

    <button onclick="logout()">로그아웃</button>
  </div>
</section>

<nav id="nav" class="hidden">
  <button onclick="show('home')">홈</button>
  <button onclick="show('community')">커뮤니티</button>
  <button onclick="show('chat')">채팅</button>
  <button onclick="show('settings')">설정</button>
</nav>

<script>
let role=null;
let artist=JSON.parse(localStorage.getItem('artist'))||{name:'AHJIN',avatar:null};
let chats=JSON.parse(localStorage.getItem('chats'))||[];
let posts=JSON.parse(localStorage.getItem('posts'))||[];

function login(){
  const email=document.getElementById('loginEmail').value.trim();
  const pw=document.getElementById('loginPw').value.trim();

  if(email==='aini@house.com' && pw==='1234'){
    role='fan';
  }else if(email==='ahjin@house.com' && pw==='01024773752'){
    role='artist';
  }else{
    alert('이메일 또는 비밀번호가 틀렸어요');
    return;
  }

  document.getElementById('login').style.display='none';
  document.getElementById('nav').classList.remove('hidden');

  if(role==='artist'){
    document.getElementById('artistSetting').classList.remove('hidden');
    document.getElementById('artistName').value=artist.name;
  }

  show('home');
  render();
}

function logout(){
  location.reload();
}

function show(id){
  document.querySelectorAll('section').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function uploadAvatar(input){
  const file=input.files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=e=>{
    artist.avatar=e.target.result;
  };
  reader.readAsDataURL(file);
}

function saveArtist(){
  artist.name=document.getElementById('artistName').value;
  localStorage.setItem('artist',JSON.stringify(artist));
  render();
}

function sendChat(){
  const input=document.getElementById('chatInput');
  if(!input.value) return;
  chats.push({
    role,
    text:input.value,
    time:new Date().toLocaleString()
  });
  localStorage.setItem('chats',JSON.stringify(chats));
  input.value='';
  renderChat();
}

function render(){
  renderChat();
  renderPosts();
}

function renderChat(){
  const box=document.getElementById('chatBox');
  box.innerHTML='';
  chats.forEach(c=>{
    const d=document.createElement('div');
    d.className='bubble '+(c.role==='artist'?'left':'right');
    d.innerHTML=`
      ${c.role==='artist'
        ? `<div class="row">
             <div class="avatar">${artist.avatar?`<img src="${artist.avatar}" class="avatar">`:''}</div>
             <b>${artist.name}</b>
           </div>` : ''}
      ${c.text}
      <div class="small">${c.time}</div>`;
    box.appendChild(d);
  });
}

function newPost(){
  if(role!=='artist') return;
  const text=prompt('내용 입력');
  if(!text) return;
  posts.unshift({text,comments:[]});
  localStorage.setItem('posts',JSON.stringify(posts));
  renderPosts();
}

function renderPosts(){
  const postsEl=document.getElementById('posts');
  postsEl.innerHTML='';
  posts.forEach((p,i)=>{
    const d=document.createElement('div');
    d.className='card';
    d.innerHTML=`
      <div class="row">
        <div class="avatar">${artist.avatar?`<img src="${artist.avatar}" class="avatar">`:''}</div>
        <b>${artist.name}</b>
      </div>
      <p class="small">${p.text}</p>
      ${p.comments.map(c=>`<div class="small">• ${c}</div>`).join('')}
      <input placeholder="댓글" onkeydown="if(event.key==='Enter'){addComment(${i},this)}">
    `;
    postsEl.appendChild(d);
  });
}

function addComment(i,input){
  if(!input.value) return;
  posts[i].comments.push(input.value);
  localStorage.setItem('posts',JSON.stringify(posts));
  renderPosts();
}
</script>

</body>
</html>
