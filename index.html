<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>DIDNA</title>
<style>
body{margin:0;font-family:system-ui,-apple-system;background:#fffbe6}
header{padding:14px;font-weight:700;text-align:center;background:#fff3b0}
.hidden{display:none}
.wrap{max-width:520px;margin:0 auto}
.box{background:#fff;margin:12px;padding:12px;border-radius:14px}
button{border:none;padding:6px 10px;border-radius:8px;background:#ffe066;font-weight:600;cursor:pointer;font-size:13px}
input,textarea{width:100%;padding:8px;margin-top:6px;border-radius:8px;border:1px solid #ddd;font-size:14px}
.nav{display:flex;gap:6px;flex-wrap:wrap}
.meta{font-size:12px;color:#888}
.artist{color:#c92a2a;font-weight:700}
.comment{font-size:14px;margin-top:6px}
.reply{margin-left:16px;font-size:13px;color:#555}
.inline{display:flex;gap:6px;margin-top:6px}
.avatar{width:26px;height:26px;border-radius:50%;vertical-align:middle;margin-right:6px;object-fit:cover}
</style>
</head>
<body>
<header>DIDNA</header>
<div class="wrap">

<!-- LOGIN -->
<div id="loginBox" class="box">
  <input id="loginId" placeholder="ID" />
  <input id="loginPw" type="password" placeholder="PW" />
  <button onclick="login()">Î°úÍ∑∏Ïù∏</button>
</div>

<!-- APP -->
<div id="app" class="hidden">

<div class="box">
  <span id="me"></span>
  <div class="nav">
    <button onclick="view='feed';render()">ÌîºÎìú</button>
    <button onclick="view='notice';render()">Í≥µÏßÄ</button>
    <button onclick="view='chat';render()">Ï±ÑÌåÖ</button>
    <button onclick="view='group';render()">Îã®Ï≤¥Ï±ÑÌåÖ</button>
    <button onclick="view='suggest';render()">Í±¥Ïùò</button>
    <button onclick="openSetting()">‚öôÔ∏è</button>
    <button id="addUserBtn" class="hidden" onclick="openAddUser()">‚ûï</button>
  </div>
</div>

<!-- WRITE -->
<div id="writeBox" class="box hidden"></div>

<!-- CONTENT -->
<div id="content"></div>

</div>
</div>

<script>
/* ===== DATA ===== */
const defaultUsers={yerin:{pw:'1234',role:'artist',name:'YERIN',avatar:''}};
let users=JSON.parse(localStorage.getItem('users'))||defaultUsers;
let data=JSON.parse(localStorage.getItem('didnaData'))||{
  feed:[], notice:[], chat:[], group:[], suggest:[], memo:[]
};
let me=null; let view='feed';

function save(){
  localStorage.setItem('users',JSON.stringify(users));
  localStorage.setItem('didnaData',JSON.stringify(data));
}

/* ===== LOGIN ===== */
function login(){
  const id=loginId.value.trim(), pw=loginPw.value.trim();
  if(!users[id]||users[id].pw!==pw){alert('Î°úÍ∑∏Ïù∏ Ïã§Ìå®');return}
  me={id,...users[id]};
  loginBox.classList.add('hidden'); app.classList.remove('hidden');
  if(me.role==='artist') writeBox.classList.remove('hidden');
  if(me.id==='yerin') addUserBtn.classList.remove('hidden');
  renderMe(); render();
}
function renderMe(){
  me.innerHTML=`${me.avatar?`<img class='avatar' src='${me.avatar}'>`:''}${me.name} ${me.role==='artist'?'üßë‚Äçüé§':''}`;
}

/* ===== WRITE BOX ===== */
function setupWrite(){
  if(view==='feed'&&me.role==='artist') writeBox.innerHTML=`<textarea id='txt' placeholder='ÌîºÎìú ÏûëÏÑ±'></textarea><button onclick="addItem('feed')">Í≤åÏãú</button>`;
  else if(view==='notice'&&me.role==='artist') writeBox.innerHTML=`<textarea id='txt' placeholder='Í≥µÏßÄ ÏûëÏÑ±'></textarea><button onclick="addItem('notice')">Í≥µÏßÄ</button>`;
  else if(view==='chat'||view==='group') writeBox.innerHTML=`<textarea id='txt' placeholder='Î©îÏãúÏßÄ'></textarea><button onclick="addItem('${view}')">Î≥¥ÎÇ¥Í∏∞</button>`;
  else if(view==='suggest'&&me.role==='fan') writeBox.innerHTML=`<textarea id='txt' placeholder='Í±¥Ïùò'></textarea><button onclick="addItem('suggest')">Î≥¥ÎÇ¥Í∏∞</button>`;
  else writeBox.innerHTML='';
}

function addItem(type){
  const t=document.getElementById('txt').value.trim(); if(!t)return;
  data[type].unshift({id:Date.now(),author:me.id,text:t,reply:[]});
  document.getElementById('txt').value=''; save(); render();
}

/* ===== RENDER ===== */
function render(){
  setupWrite(); content.innerHTML='';
  data[view].forEach((p,i)=>{
    const u=users[p.author];
    const d=document.createElement('div'); d.className='box';
    d.innerHTML=`
      <div class='meta ${u.role==='artist'?'artist':''}'>${u.name}</div>
      <div>${p.text}</div>
      ${view==='suggest'&&me.role==='artist'?`<div class='inline'><input placeholder='ÎãµÎ≥Ä'><button onclick="replyItem('${view}',${i},this.previousElementSibling)">Î≥¥ÎÇ¥Í∏∞</button></div>`:''}
      ${(p.reply||[]).map(r=>`<div class='reply'>${users[r.author].name}: ${r.text}</div>`).join('')}
    `;
    content.appendChild(d);
  });
}

function replyItem(type,i,input){
  const t=input.value.trim(); if(!t)return;
  data[type][i].reply.push({author:me.id,text:t}); input.value=''; save(); render();
}

/* ===== SETTINGS ===== */
function openSetting(){
  const name=prompt('Ïù¥Î¶Ñ',me.name);
  const pw=prompt('ÎπÑÎ∞ÄÎ≤àÌò∏',me.pw);
  const av=prompt('ÌîÑÏÇ¨ URL',me.avatar||'');
  if(name) users[me.id].name=me.name=name;
  if(pw) users[me.id].pw=me.pw=pw;
  if(av!==null) users[me.id].avatar=me.avatar=av;
  save(); renderMe(); render();
}

/* ===== ADMIN ===== */
function openAddUser(){
  const id=prompt('ID'), pw=prompt('PW'), role=prompt('fan/artist'), name=prompt('Ïù¥Î¶Ñ');
  if(id&&pw&&role){ users[id]={pw,role,name:name||id,avatar:''}; save(); alert('Í≥ÑÏ†ï Ï∂îÍ∞Ä ÏôÑÎ£å'); }
}
</script>
</body>
</html>



